!function(){var t,o,n,e="https://static.fjrst.cn/monitor/v1/",i="",a=!1,s="",d="",r=null,c=!1;function p(e){clearInterval(r),b(e),r=setInterval(function(){b(e)},3e3)}function l(){clearInterval(r)}function x(t){c=!0,v.ajaxRequest({url:e+"token",method:"post",dataType:"json",data:{idCard:"3501241980xxxxx",appId:"eb7200f7fc45460d96507c4fa03b3934",appSecret:"xxxxxxxx完成申请流程后可查看"},success:function(e){0==e.code&&(s=e.access_token),t(e)},error:function(e){t({code:500,msg:"token获取失败"})}})}function u(t){x(function(e){t(e),500==e.code&&p(t)})}function b(t){v.ajaxRequest({url:e+"heartbeat",method:"get",data:{token:s,courseId:i},success:function(e){0==e.code&&t(e),1==e.code&&(l(),h(!0),t(e)),410==e.code&&(l(),alert(e.msg||"token验证失败"),t(e))},error:function(e){h(!0),t({code:500,msg:"心跳包异常"})}})}function f(t){v.ajaxRequest({url:e+"checkCode",data:{token:s,code:d},success:function(e){h(),0==e.code?a||u(t):alert(e.msg),t(e)},error:function(e){t({code:500,msg:"验证失败"})}})}function y(){c&&v.ajaxRequest({url:e+"studyEnd",data:{token:s,courseId:i},success:function(e){e.code},error:function(e){}})}function h(e){var t=document.getElementsByClassName("zypx-message-box__wrapper");g(),t[0].style.cssText=e?"visibility:inherit":"visibility:hidden"}function g(e){var t=document.getElementsByClassName("zypx-tip-box__text");t[0].style.cssText=e?"visibility:inherit":"visibility:hidden"}window.onload=function(){!function(){var e=document.createElement("div");e.innerHTML=`<div class="zypx-message-box__wrapper">
            <div class="zypx-message-box">
                <div class="zypx-message-box__header">
                    <div class="zypx-message-box__title">输入验证码</div>
                    <button class="zypx-message-box__headerbtn">X</button>
                </div>
                <div class="zypx-message-box__content">
                    <div class="zypx-alert">学员通过“职补小助手”小程序进行人脸验证后可查看验证码。</div>
                    <div class="zypx-input">
                        <input type="text" id="code-value" class="zypx-input__inner" placeholder="请输入">
                    </div>
                    <div class="zypx-tip-box">
                        <span class="zypx-tip-box__text">请输入验证码</span>
                    </div>
                </div>
                <div class="zypx-message-box__btns">
                    <button id="submit-btn" class="zypx-button">提交</button>
                </div>
            </div>
        </div>`,document.body.appendChild(e);var t=document.createElement("style");t.type="text/css",t.styleSheet?t.styleSheet.cssText=m:t.innerHTML=m;document.getElementsByTagName("head")[0].appendChild(t);var e=document.getElementsByClassName("zypx-message-box__headerbtn"),t=document.getElementById("submit-btn"),o=document.getElementById("code-value");e[0].onclick=function(){h()},t.onclick=function(){(d=o.value)?f(function(e){0==e.code&&h()}):g(!0)}}()},window.zypx={init:function(e){t=e.appId,o=e.appSecret,n=e.idCard,i=e.courseId,(a=e.control)?e.callback&&e.callback({appId:t,appSecret:o,idCard:n,courseId:i,control:a}):this.autoExec(e.callback||function(e){})},autoExec:function(e){u(e)},start:function(e){x(e)},watch:function(e){p(e)},stop:function(){clearInterval(r)},submitCode:function(e){f(e)},over:function(){y()}},window.addEventListener?window.addEventListener("beforeunload",y,!1):window.attachEvent?window.attachEvent("onbeforeunload",y):window.onbeforeunload&&(window.onbeforeunload=y);var m=`.zypx-message-box__wrapper {
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        flex-flow: row nowrap;
        align-items: center;
        justify-content: center;
        visibility: hidden;
    }
    
    .zypx-message-box {
        display: inline-block;
        width: 420px;
        padding-bottom: 10px;
        vertical-align: middle;
        background-color: #fff;
        border-radius: 4px;
        border: 1px solid #ebeef5;
        font-size: 18px;
        box-shadow: 0 2px 12px 0 rgb(0 0 0 / 10%);
        text-align: left;
        overflow: hidden;
        backface-visibility: hidden;
    }
    
    .zypx-message-box__header {
        position: relative;
        padding: 15px 15px 10px;
    }
    .zypx-message-box__title {
        padding-left: 0;
        margin-bottom: 0;
        font-size: 18px;
        line-height: 1;
        color: #303133;
    }
    .zypx-message-box__headerbtn {
        position: absolute;
        top: 15px;
        right: 15px;
        padding: 0;
        border: none;
        outline: none;
        background: transparent;
        font-size: 16px;
        cursor: pointer;
        color: #aaa;
        font-weight: bold;
    }
    .zypx-message-box__headerbtn:hover {
        color: #409eff;
    }
    .zypx-message-box__content {
        padding: 10px 15px;
        color: #606266;
        font-size: 14px;
    }
    .zypx-message-box__btns {
        padding: 5px 15px 0;
        text-align: right;
    }
    
    .zypx-button {
        display: inline-block;
        line-height: 1;
        white-space: nowrap;
        cursor: pointer;
        background: #fff;
        border: 1px solid #dcdfe6;
        -webkit-appearance: none;
        text-align: center;
        box-sizing: border-box;
        outline: none;
        margin: 0;
        transition: .1s;
        font-weight: 500;
        padding: 9px 15px;
        font-size: 12px;
        border-radius: 3px;
        color: #fff;
        background-color: #409eff;
        border-color: #409eff;
    }
    
    .zypx-input {
        position: relative;
        font-size: 14px;
        display: inline-block;
        width: 100%;
    }
    .zypx-input__inner {
        -webkit-appearance: none;
        background-color: #fff;
        background-image: none;
        border-radius: 4px;
        border: 1px solid #dcdfe6;
        box-sizing: border-box;
        color: #606266;
        display: inline-block;
        font-size: inherit;
        height: 40px;
        line-height: 40px;
        outline: none;
        padding: 0 15px;
        transition: border-color .2s cubic-bezier(.645,.045,.355,1);
        width: 100%;
    }
    .zypx-input__inner:hover {
        border: 1px solid #409eff;
    }
    
    .zypx-alert {
        width: 100%;
        padding: 8px 16px;
        margin: 0 0 15px;
        box-sizing: border-box;
        border-radius: 4px;
        position: relative;
        background-color: #e6a23c;
        color: #fff;
        overflow: hidden;
        opacity: 1;
        display: flex;
        align-items: center;
        transition: opacity .2s;
        font-size: 12px;
    }
    .zypx-tip-box {
        height: 24px;
        line-height: 24px;
        color: red;
        font-size: 12px;
    }
    .zypx-tip-box__text {
        visibility: hidden;
    }`,v={ajaxRequest:function(o){(o=o||{}).method=(o.method||"POST").toUpperCase(),o.dataType=o.dataType||"json",o.contentType=o.contentType||"application/json;charset=UTF-8",o.headers=o.headers||{},o.data=o.data||null,o.timeout=o.timeout||1e4,o.async=o.async||!0;var e=[];if(o.data&&"object"==typeof o.data){for(var t in o.data)e.push(t+"="+o.data[t]);e.push(("v="+Math.random()).replace(".","")),e=e.join("&")}var n,i=localStorage.getItem("authorization");if(i&&(o.headers.authorization=i),window.XMLHttpRequest?n=new XMLHttpRequest:window.ActiveObject&&(n=new ActiveXobject("Microsoft.XMLHTTP")),"GET"===o.method)n.open("GET",o.url+"?"+e,o.async),n.send(null);else if("POST"==o.method){for(var a in n.open("POST",o.url,o.async),n.setRequestHeader("x-requested-with","XMLHttpRequest"),n.setRequestHeader("cache-control","no-cache"),n.setRequestHeader("Content-type",o.contentType),o.headers)n.setRequestHeader(a,o.headers[a]);if(0<o.contentType.toLowerCase().indexOf("json")){if("object"==typeof o.data)try{o.data=JSON.stringify(o.data)}catch(e){}n.send(o.data)}else n.send(e)}setTimeout(function(){4!=n.readySate&&n.abort()},o.timeout),n.onreadystatechange=function(){var e,t=n.status;4==n.readyState&&(200<=t&&t<300||304===t?(console.log(n.responseXML),"json"===o.dataType?401!=(e=JSON.parse(n.responseText)).code?o.success&&o.success(e,t,n.responseXML):window.location.href="account":o.success&&o.success(n.responseText,t,n.responseXML)):o.error&&o.error(t))}}}}();