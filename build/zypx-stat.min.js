"use strict";function _typeof(n){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}!function(){var e,t,o,n="https://static.fjrst.cn/monitor/v1/",i="",a=!1,s="",r="",d=null,c=!1,p="";function l(n){clearInterval(d),b(n),d=setInterval(function(){b(n)},3e3)}function u(){clearInterval(d)}function x(e){c=!0,v.ajaxRequest({url:n+"token",method:"post",dataType:"json",data:{idCard:"3501241980xxxxx",appId:"eb7200f7fc45460d96507c4fa03b3934",appSecret:"xxxxxxxx完成申请流程后可查看"},success:function(n){0==n.code&&(s=n.access_token),e(n)},error:function(n){e({code:500,msg:"token获取失败"})}})}function f(e){x(function(n){e(n),500==n.code&&l(e)})}function b(e){v.ajaxRequest({url:n+"heartbeat",method:"get",data:{token:s,courseId:i},success:function(n){0==n.code&&e(n),1==n.code&&(u(),h(!0),e(n)),410==n.code&&(u(),alert(n.msg||"token验证失败"),e(n))},error:function(n){e({code:500,msg:"心跳包异常"})}})}function y(e){v.ajaxRequest({url:n+"checkCode",data:{token:s,code:r},success:function(n){h(),0==n.code?a||f(e):alert(n.msg),e(n)},error:function(n){e({code:500,msg:"验证失败"})}})}function g(){c&&v.ajaxRequest({url:n+"studyEnd",data:{token:s,courseId:i},success:function(n){n.code},error:function(n){}})}function h(n){var e=document.getElementsByClassName("zypx-message-box__wrapper");m(),e[0].style.cssText=n?"visibility:inherit":"visibility:hidden"}function m(n){var e=document.getElementsByClassName("zypx-tip-box__text");e[0].style.cssText=n?"visibility:inherit":"visibility:hidden"}window.onload=function(){!function(){var n=document.createElement("div");p&&("#"==p[0]?n.id=p.substring(1):"."==p[0]?n.className=p.substring(1):n.id=p);n.innerHTML='\n      <div class="zypx-message-box__wrapper">\n        <div class="zypx-message-box">\n          <div class="zypx-message-box__header">\n            <div class="zypx-message-box__title">输入验证码</div>\n            <button class="zypx-message-box__headerbtn">X</button>\n          </div>\n          <div class="zypx-message-box__content">\n            <div class="zypx-alert">学员通过“职补小助手”小程序进行人脸验证后可查看验证码。</div>\n            <div class="zypx-input">\n              <input type="text" id="code-value" class="zypx-input__inner" placeholder="请输入">\n            </div>\n            <div class="zypx-tip-box">\n              <span class="zypx-tip-box__text">请输入验证码</span>\n            </div>\n          </div>\n          <div class="zypx-message-box__btns">\n            <button id="submit-btn" class="zypx-button">提交</button>\n          </div>\n        </div>\n      </div>',document.body.appendChild(n);var e=document.createElement("style");e.type="text/css",e.styleSheet?e.styleSheet.cssText=w:e.innerHTML=w;document.getElementsByTagName("head")[0].appendChild(e);var n=document.getElementsByClassName("zypx-message-box__headerbtn"),e=document.getElementById("submit-btn"),t=document.getElementById("code-value");n[0].onclick=function(){h()},e.onclick=function(){(r=t.value)?y(function(n){0==n.code&&h()}):m(!0)}}()},window.zypx={init:function(n){e=n.appId,t=n.appSecret,o=n.idCard,i=n.courseId,a=n.control,p=n.selector,n.callback&&n.callback({appId:e,appSecret:t,idCard:o,courseId:i,control:a,msg:"插件初始化完成"}),a||this.autoExec(n.callback||function(n){})},autoExec:function(n){f(n)},start:function(n){x(n)},watch:function(n){l(n)},stop:function(){clearInterval(d)},submitCode:function(n){y(n)},over:function(){g()}},window.addEventListener?window.addEventListener("beforeunload",g,!1):window.attachEvent?window.attachEvent("onbeforeunload",g):window.onbeforeunload&&(window.onbeforeunload=g);var v={ajaxRequest:function(t){(t=t||{}).method=(t.method||"POST").toUpperCase(),t.dataType=t.dataType||"json",t.contentType=t.contentType||"application/json;charset=UTF-8",t.headers=t.headers||{},t.data=t.data||null,t.timeout=t.timeout||1e4,t.async=t.async||!0;var n=[];if(t.data&&"object"===_typeof(t.data)){for(var e in t.data)n.push(e+"="+t.data[e]);n.push(("v="+Math.random()).replace(".","")),n=n.join("&")}var o,i=localStorage.getItem("authorization");if(i&&(t.headers.authorization=i),window.XMLHttpRequest?o=new XMLHttpRequest:window.ActiveObject&&(o=new ActiveXobject("Microsoft.XMLHTTP")),"GET"===t.method)o.open("GET",t.url+"?"+n,t.async),o.send(null);else if("POST"==t.method){for(var a in o.open("POST",t.url,t.async),o.setRequestHeader("x-requested-with","XMLHttpRequest"),o.setRequestHeader("cache-control","no-cache"),o.setRequestHeader("Content-type",t.contentType),t.headers)o.setRequestHeader(a,t.headers[a]);if(0<t.contentType.toLowerCase().indexOf("json")){if("object"===_typeof(t.data))try{t.data=JSON.stringify(t.data)}catch(n){}o.send(t.data)}else o.send(n)}setTimeout(function(){4!=o.readySate&&o.abort()},t.timeout),o.onreadystatechange=function(){var n,e=o.status;4==o.readyState&&(200<=e&&e<300||304===e?(console.log(o.responseXML),"json"===t.dataType?401!=(n=JSON.parse(o.responseText)).code?t.success&&t.success(n,e,o.responseXML):window.location.href="account":t.success&&t.success(o.responseText,e,o.responseXML)):t.error&&t.error(e))}}},w="\n    .zypx-message-box__wrapper {\n      position: fixed;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.5);\n      display: flex;\n      flex-flow: row nowrap;\n      align-items: center;\n      justify-content: center;\n      visibility: hidden;\n    }\n    \n    .zypx-message-box {\n      display: inline-block;\n      width: 420px;\n      padding-bottom: 10px;\n      vertical-align: middle;\n      background-color: #fff;\n      border-radius: 4px;\n      border: 1px solid #ebeef5;\n      font-size: 18px;\n      box-shadow: 0 2px 12px 0 rgb(0 0 0 / 10%);\n      text-align: left;\n      overflow: hidden;\n      backface-visibility: hidden;\n    }\n    \n    .zypx-message-box__header {\n      position: relative;\n      padding: 15px 15px 10px;\n    }\n    .zypx-message-box__title {\n      padding-left: 0;\n      margin-bottom: 0;\n      font-size: 18px;\n      line-height: 1;\n      color: #303133;\n    }\n    .zypx-message-box__headerbtn {\n      position: absolute;\n      top: 15px;\n      right: 15px;\n      padding: 0;\n      border: none;\n      outline: none;\n      background: transparent;\n      font-size: 16px;\n      cursor: pointer;\n      color: #aaa;\n      font-weight: bold;\n    }\n    .zypx-message-box__headerbtn:hover {\n      color: #409eff;\n    }\n    .zypx-message-box__content {\n      padding: 10px 15px;\n      color: #606266;\n      font-size: 14px;\n    }\n    .zypx-message-box__btns {\n      padding: 5px 15px 0;\n      text-align: right;\n    }\n    \n    .zypx-button {\n      display: inline-block;\n      line-height: 1;\n      white-space: nowrap;\n      cursor: pointer;\n      background: #fff;\n      border: 1px solid #dcdfe6;\n      -webkit-appearance: none;\n      text-align: center;\n      box-sizing: border-box;\n      outline: none;\n      margin: 0;\n      transition: .1s;\n      font-weight: 500;\n      padding: 9px 15px;\n      font-size: 12px;\n      border-radius: 3px;\n      color: #fff;\n      background-color: #409eff;\n      border-color: #409eff;\n    }\n    \n    .zypx-input {\n      position: relative;\n      font-size: 14px;\n      display: inline-block;\n      width: 100%;\n    }\n    .zypx-input__inner {\n      -webkit-appearance: none;\n      background-color: #fff;\n      background-image: none;\n      border-radius: 4px;\n      border: 1px solid #dcdfe6;\n      box-sizing: border-box;\n      color: #606266;\n      display: inline-block;\n      font-size: inherit;\n      height: 40px;\n      line-height: 40px;\n      outline: none;\n      padding: 0 15px;\n      transition: border-color .2s cubic-bezier(.645,.045,.355,1);\n      width: 100%;\n    }\n    .zypx-input__inner:hover {\n      border: 1px solid #409eff;\n    }\n    \n    .zypx-alert {\n      width: 100%;\n      padding: 8px 16px;\n      margin: 0 0 15px;\n      box-sizing: border-box;\n      border-radius: 4px;\n      position: relative;\n      background-color: #e6a23c;\n      color: #fff;\n      overflow: hidden;\n      opacity: 1;\n      display: flex;\n      align-items: center;\n      transition: opacity .2s;\n      font-size: 12px;\n    }\n    .zypx-tip-box {\n      height: 24px;\n      line-height: 24px;\n      color: red;\n      font-size: 12px;\n    }\n    .zypx-tip-box__text {\n      visibility: hidden;\n    }"}();